# Define your pipeline
trigger:
- main

pr:
- none

pool:
  vmImage: 'windows-latest'

# Define stages
stages:
- stage: Build
  displayName: 'Build and Publish'
  jobs:
    - job: Build
      displayName: 'Build'
      steps:
        - task: UseDotNet@2
          inputs:
            packageType: 'sdk'
            version: '6.x'
          displayName: 'Install .NET SDK'

        - script: |
            dotnet restore
            dotnet build --configuration Release
            dotnet publish --configuration Release --output $(Build.ArtifactStagingDirectory)/MyApp
          displayName: 'Build and Publish'

        - task: PublishBuildArtifacts@1
          displayName: 'Publish Artifact'
          inputs:
            pathtoPublish: '$(Build.ArtifactStagingDirectory)/MyApp'
            artifactName: 'drop'
            publishLocation: 'Container'

- stage: Deploy
  displayName: 'Deploy to Azure'
  jobs:
    - job: Deploy
      displayName: 'Deploy'
      steps:
        - task: DownloadBuildArtifacts@0
          inputs:
            artifactName: 'drop'
            downloadPath: '$(Build.ArtifactStagingDirectory)'

        - task: AzureWebApp@1
          displayName: 'Deploy to Azure Web App'
          inputs:
            azureSubscription: 'YourAzureSubscription'
            appName: 'YourAzureWebAppName'
            package: '$(Build.ArtifactStagingDirectory)/**/*.zip'

